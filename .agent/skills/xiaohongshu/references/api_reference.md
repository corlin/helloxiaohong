# 小红书页面元素和操作说明

## 页面结构

### 1. 探索页面 (https://www.xiaohongshu.com/explore)
用于检查登录状态的页面

#### 登录状态检测元素
- **选择器**: `.main-container .user .link-wrapper .channel`
- **用途**: 检测用户是否已登录
- **存在**: 用户已登录
- **不存在**: 用户未登录

### 2. 发布页面 (https://creator.xiaohongshu.com/publish/publish?source=official)
用于发布内容的页面

#### 主要元素选择器

##### 发布标签
- **选择器**: `div.creator-tab`
- **用途**: 切换发布类型（图文/视频）
- **操作**: 点击"上传图文"标签

##### 图片上传
- **选择器**: `.upload-input`
- **用途**: 上传图片文件
- **操作**: 设置文件路径

##### 图片预览
- **选择器**: `.img-preview-area .pr`
- **用途**: 显示已上传的图片
- **用途**: 检查上传进度

##### 标题输入
- **选择器**: `div.d-input input`
- **用途**: 输入内容标题
- **限制**: 最多20个中文字或英文单词

##### 标题长度检查
- **选择器**: `div.title-container div.max_suffix`
- **用途**: 检查标题长度是否超限
- **出现**: 表示长度超限

##### 正文输入
- **选择器**: `div.ql-editor` 或 `p[data-placeholder]`
- **用途**: 输入正文内容
- **占位符**: "输入正文描述"

##### 内容长度检查
- **选择器**: `div.edit-container div.length-error`
- **用途**: 检查内容长度是否超限
- **出现**: 表示长度超限

##### 标签容器
- **选择器**: `#creator-editor-topic-container .item`
- **用途**: 显示已添加的标签

##### 提交按钮
- **选择器**: `div.submit div.d-button-content`
- **用途**: 提交发布内容

##### 弹出遮挡
- **选择器**: `div.d-popover`
- **用途**: 可能遮挡操作的弹出元素
- **处理**: 移除该元素

## 操作流程

### 1. 检查登录状态
1. 访问探索页面
2. 等待页面加载完成
3. 查找登录状态元素
4. 根据元素存在与否判断登录状态

### 2. 发布内容
1. 访问发布页面
2. 点击"上传图文"标签
3. 上传图片文件
4. 等待图片上传完成
5. 填写标题
6. 填写正文内容
7. 添加标签
8. 提交发布

## 注意事项

### 元素等待
- 使用 `waitForSelector` 等待元素出现
- 设置合理的超时时间
- 处理元素不存在的情况

### 遮挡处理
- 检查元素是否被其他元素遮挡
- 移除弹出遮挡元素
- 确保操作元素可点击

### 错误处理
- 检查标题和内容长度限制
- 验证图片上传状态
- 处理网络加载问题

### 浏览器状态
- 使用持久化上下文保存登录状态
- 合理设置浏览器视口大小
- 处理页面加载和重定向

## 常见问题

### 1. 登录状态检测失败
- 检查页面是否完全加载
- 确认选择器是否正确
- 处理网络延迟问题

### 2. 图片上传失败
- 检查图片文件是否存在
- 确认图片格式是否支持
- 处理上传超时问题

### 3. 内容提交失败
- 检查所有必填字段
- 确认内容长度符合要求
- 处理网络连接问题

### 4. 元素定位失败
- 检查页面结构是否变化
- 更新元素选择器
- 增加等待时间

## 调试技巧

### 1. 开启无头模式
- 设置 `headless: false` 查看操作过程
- 使用浏览器开发者工具检查元素

### 2. 添加日志输出
- 记录关键操作步骤
- 输出元素状态信息
- 显示错误详情

### 3. 增加延迟
- 在关键步骤添加适当延迟
- 等待动画和过渡效果完成
- 处理异步加载内容